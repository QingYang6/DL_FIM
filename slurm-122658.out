LSB Version:	:core-4.1-amd64:core-4.1-noarch
Distributor ID:	RedHatEnterprise
Description:	Red Hat Enterprise Linux release 8.7 (Ootpa)
Release:	8.7
Codename:	Ootpa
SLURM_JOBID 122658 SLURM_JOBID
1.12.1
----------------- Options ---------------
                     CtoE: False                         
                      DEM: True                          
                NE_MARGIN: True                          
          NE_MARGIN_VALUE: -0.25                         
                    activ: lrelu                         
                    batch: AdaIn                         	[default: batch]
               batch_size: 10                            	[default: 1]
                    beta1: 0.5                           
          checkpoints_dir: checkpoints                   
           continue_train: True                          
                crop_size: 256                           
                 dataroot: /gpfs/sharedfs1/manoslab/data/Qdata/GAN_CD/Sample_Preare/Huston/U10T24_S1S1S2_LCCDEM_O30_R200_128_QF	[default: None]
             dataset_mode: S1S2IALCCDEM                  	[default: Land2S1]
                direction: AtoB                          
              display_env: main                          
             display_freq: 400                           
               display_id: 1                             
            display_ncols: 4                             
             display_port: 8097                          
           display_server: http://localhost              
          display_winsize: 256                           
                    epoch: latest                        
              epoch_count: 1                             
                 gan_mode: wgangp                        	[default: lsgan]
                    gan_w: 1                             
                  gpu_ids: 0                             
                init_gain: 0.02                          
                init_type: kaiming                       
                 input_nc: 6                             
                  isTrain: True                          	[default: None]
               lambda_LDS: 1                             
               latent_dim: 9                             
                load_iter: 0                             	[default: 0]
                load_size: 256                           
                  log_dir: log                           
                       lr: 0.0004                        	[default: 0.0002]
           lr_decay_iters: 50                            
                lr_policy: linear                        
              main_ex_dir: /gpfs/sharedfs1/manoslab/data/Qdata/GAN_OUTPUT
         max_dataset_size: inf                           
                  mlp_dim: 256                           
                    model: DS3XINC                       	[default: pix2pix_attn]
             n_downsample: 2                             
               n_layers_D: 3                             
                    n_res: 4                             
                     name: DS3XINC_S1S1LIALCCDEMSLRL_diversity_U10_condi_SGD__S1S2IALCCDEM_DS3XINC_AdaINGen_3X2E_wgangp_NormAdaIn_batchsize10	[default: experiment_name]
                      ndf: 64                            
                     netD: MsImageDis                    
                     netG: AdaINGen_3X2E                 
                      ngf: 64                            
                    niter: 30                            	[default: 100]
              niter_decay: 120                           	[default: 100]
               no_dropout: True                          
                  no_flip: False                         
                  no_html: False                         
                     norm: AdaIn                         
                num_class: 1                             
              num_threads: 8                             
                output_nc: 2                             	[default: 1]
                 pad_type: reflect                       
                    phase: train                         
                pool_size: 50                            
             predict_freq: 20000                         
               preprocess: resize_and_crop               
               print_freq: 50                            
                recon_c_w: 1                             
                recon_s_w: 1                             
            recon_x_cyc_w: 10                            
                recon_x_w: 10                            
              results_dir: results                       
             save_by_iter: False                         
          save_epoch_freq: 1                             	[default: 5]
         save_latest_freq: 50000                         	[default: -1]
           serial_batches: False                         
              split_ratio: 0.02                          
            split_shuffle: False                         
                style_dim: 8                             
                   suffix: _{dataset_mode}_{model}_{netG}_{gan_mode}_Norm{batch}_batchsize{batch_size}
         update_html_freq: 1000                          
               use_same_D: True                          
               use_same_G: True                          
             valid_batchs: 20                            
              valid_nrows: 5                             
                  verbose: False                         
                    vgg_w: 1                             
----------------- End -------------------
Train dataset [S1S2IALCCDEMDataset] was created
Vali dataset [Subset] was created
The number of training images = 112262
The number of validating images = 2292
Use GPU!
NVIDIA A100-PCIE-40GB
initialize network with kaiming
/home/qiy17007/miniconda3/envs/torch3/lib/python3.9/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and will be removed in 0.15, please use 'weights' instead.
  warnings.warn(
/home/qiy17007/miniconda3/envs/torch3/lib/python3.9/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and will be removed in 0.15. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
initialize network with kaiming
/home/qiy17007/miniconda3/envs/torch3/lib/python3.9/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='none' instead.
  warnings.warn(warning.format(ret))
model [DS3XINCModel] was created
---------- Networks initialized -------------
[Network G_A] Total number of parameters : 44.078 M
[Network D_A] Total number of parameters : 1.984 M
-----------------------------------------------
create web directory /gpfs/sharedfs1/manoslab/data/Qdata/GAN_OUTPUT/DS3XINC_S1S1LIALCCDEMSLRL_diversity_U10_condi_SGD__S1S2IALCCDEM_DS3XINC_AdaINGen_3X2E_wgangp_NormAdaIn_batchsize10/checkpoints/DS3XINC_S1S1LIALCCDEMSLRL_diversity_U10_condi_SGD__S1S2IALCCDEM_DS3XINC_AdaINGen_3X2E_wgangp_NormAdaIn_batchsize10/web...
Traceback (most recent call last):
  File "/shared/stormcenter/Qing_Y/GAN_ChangeDetection/ASGIT/train_novisdom.py", line 79, in <module>
    model.optimize_parameters()   # calculate loss functions, get gradients, update network weights
  File "/shared/stormcenter/Qing_Y/GAN_ChangeDetection/ASGIT/models/DS3XINC_model.py", line 410, in optimize_parameters
    self.forward()      # compute fake images and reconstruction images.
  File "/shared/stormcenter/Qing_Y/GAN_ChangeDetection/ASGIT/models/DS3XINC_model.py", line 243, in forward
    self.xb_secrecon = self.netG_A.decode(self.cb_recon_xb1, self.s_b_prime, self.condi_b) if self.opt.recon_x_cyc_w > 0 else None
  File "/shared/stormcenter/Qing_Y/GAN_ChangeDetection/ASGIT/models/networks.py", line 1543, in decode
    images = self.dec(con_cat)
  File "/home/qiy17007/miniconda3/envs/torch3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/shared/stormcenter/Qing_Y/GAN_ChangeDetection/ASGIT/models/networks.py", line 1717, in forward
    return self.model(x)
  File "/home/qiy17007/miniconda3/envs/torch3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/qiy17007/miniconda3/envs/torch3/lib/python3.9/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/qiy17007/miniconda3/envs/torch3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/shared/stormcenter/Qing_Y/GAN_ChangeDetection/ASGIT/models/networks.py", line 1731, in forward
    return self.model(x)
  File "/home/qiy17007/miniconda3/envs/torch3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/qiy17007/miniconda3/envs/torch3/lib/python3.9/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/qiy17007/miniconda3/envs/torch3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/shared/stormcenter/Qing_Y/GAN_ChangeDetection/ASGIT/models/networks.py", line 1761, in forward
    out = self.model(x)
  File "/home/qiy17007/miniconda3/envs/torch3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/qiy17007/miniconda3/envs/torch3/lib/python3.9/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/qiy17007/miniconda3/envs/torch3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/shared/stormcenter/Qing_Y/GAN_ChangeDetection/ASGIT/models/networks.py", line 1819, in forward
    x = self.conv(self.pad(x))
  File "/home/qiy17007/miniconda3/envs/torch3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/qiy17007/miniconda3/envs/torch3/lib/python3.9/site-packages/torch/nn/modules/padding.py", line 174, in forward
    return F.pad(input, self.padding, 'reflect')
RuntimeError: CUDA out of memory. Tried to allocate 24.00 MiB (GPU 0; 39.59 GiB total capacity; 36.72 GiB already allocated; 6.12 MiB free; 37.97 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
